<%
  path_bg = case path.color
    when 'red' then 'bg-gradient-to-br from-red-50 to-red-100 border-red-400'
    when 'blue' then 'bg-gradient-to-br from-blue-50 to-blue-100 border-blue-400'
    when 'green' then 'bg-gradient-to-br from-green-50 to-green-100 border-green-400'
    when 'yellow' then 'bg-gradient-to-br from-yellow-50 to-yellow-100 border-yellow-400'
    when 'purple' then 'bg-gradient-to-br from-purple-50 to-purple-100 border-purple-400'
  end

  color_emoji = case path.color
    when 'red' then 'ðŸ”´'
    when 'blue' then 'ðŸ”µ'
    when 'green' then 'ðŸŸ¢'
    when 'yellow' then 'ðŸŸ¡'
    when 'purple' then 'ðŸŸ£'
  end
%>

<div class="border-3 rounded-xl p-4 shadow-sm <%= path_bg %>">
  <div class="flex justify-between items-start mb-3">
    <div>
      <div class="text-lg font-bold capitalize flex items-center gap-2">
        <span><%= color_emoji %> <%= path.color %></span>
        <% if path.color == 'yellow' && path.cards.length >= 1 %>
          <span class="text-xs px-2 py-1 bg-yellow-300 text-yellow-900 rounded-full font-bold border-2 border-yellow-500">âœ“ DONE</span>
        <% end %>
      </div>
    </div>
    <div class="text-right bg-white rounded-lg px-3 py-2 border-2 border-gray-300 shadow-sm">
      <div class="text-2xl font-bold text-gray-800"><%= path.score %></div>
      <div class="text-xs text-gray-600 font-medium"><%= path.cards.length %>Â² cards</div>
    </div>
  </div>

  <!-- Scoring preview -->
  <% if path.color == 'yellow' && path.cards.length >= 1 %>
    <div class="text-sm bg-yellow-200 border border-yellow-400 text-yellow-900 rounded-lg px-3 py-2 mb-3 font-medium">
      ðŸš« Yellow paths can only have 1 card
    </div>
  <% else %>
    <% next_card_count = path.cards.length + 1 %>
    <% next_score = next_card_count ** 2 %>
    <% score_gain = next_score - path.score %>
    <div class="text-sm bg-white bg-opacity-70 border-2 border-gray-300 rounded-lg px-3 py-2 mb-3 flex justify-between items-center">
      <span class="text-gray-700 font-medium">Add one more card:</span>
      <span class="font-bold text-green-700 text-lg">+<%= score_gain %> pts</span>
    </div>
  <% end %>

  <!-- Valid next plays hint -->
  <div class="text-sm mb-3 px-3 py-2 bg-white bg-opacity-90 rounded-lg border-2
    <%= case path.color
        when 'red' then 'border-red-400 bg-red-50'
        when 'blue' then 'border-blue-400 bg-blue-50'
        when 'green' then 'border-green-400 bg-green-50'
        when 'yellow' then 'border-yellow-400 bg-yellow-50'
        when 'purple' then 'border-purple-400 bg-purple-50'
        end %>">
    <div class="flex items-start gap-2">
      <span class="text-lg">ðŸ’¡</span>
      <div>
        <span class="font-bold text-gray-800">Valid plays:</span>
        <span class="text-gray-700"><%= path.next_play_hint %></span>
      </div>
    </div>
  </div>

  <div class="flex flex-wrap gap-2">
    <% path.cards.each do |card| %>
      <div class="w-16 h-20 rounded-lg border-2 flex flex-col items-center justify-center bg-white
        <%= case card['color']
            when 'red' then 'border-red-500 text-red-600'
            when 'blue' then 'border-blue-500 text-blue-600'
            when 'green' then 'border-green-500 text-green-600'
            when 'yellow' then 'border-yellow-500 text-yellow-600'
            when 'purple' then 'border-purple-500 text-purple-600'
            end %>">
        <div class="text-3xl font-bold"><%= card['number'] %></div>
      </div>
    <% end %>
  </div>
</div>
